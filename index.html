<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRM Hotel by Asep Suhendar</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- External JS Libraries -->
    <!-- Icons: Lucide -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Chart.js for Dashboard Charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- jsPDF for PDF Generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
    <!-- SheetJS (xlsx) for Excel Export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <!-- FullCalendar for Calendar View -->
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js"></script>
    <!-- Leaflet.js for Maps -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <!-- Link to your new external stylesheet -->
    <link rel="stylesheet" href="style.css">

    <!-- Tailwind CSS Component Styles (for CDN) -->
    <style type="text/tailwindcss">
        @layer components {
            .stat-card {
                @apply bg-[var(--bg-secondary)] p-4 lg:p-6 rounded-lg shadow-lg relative overflow-hidden flex flex-col justify-between;
            }
        }
    </style>
    <style>
        /* Smooth Modal Transitions */
        .modal {
            transition: opacity 0.3s ease-in-out;
        }
        .modal-content {
            transition: transform 0.3s ease-in-out;
        }
    </style>
    <style>
        /* Collapsed Sidebar Styles for Desktop */
        @media (min-width: 1024px) {
            #sidebar, main {
                transition: all 0.3s ease-in-out;
            }
            #app-container.sidebar-collapsed #sidebar {
                width: 80px;
            }
            #app-container.sidebar-collapsed #sidebar .link-text,
            #app-container.sidebar-collapsed #sidebar h3 {
                display: none;
            }
            #app-container.sidebar-collapsed #sidebar .sidebar-header {
                padding: 1rem;
                justify-content: center;
            }
            #app-container.sidebar-collapsed #sidebar .nav-link,
            #app-container.sidebar-collapsed #sidebar #sidebar-logout-button {
                justify-content: center;
                padding-left: 0;
                padding-right: 0;
            }
            #app-container.sidebar-collapsed #sidebar .nav-link i,
            #app-container.sidebar-collapsed #sidebar #sidebar-logout-button i {
                margin-right: 0;
                width: 1.5rem; /* 24px */
                height: 1.5rem; /* 24px */
            }
            #app-container.sidebar-collapsed #sidebar .sidebar-section-divider {
                margin: 0.75rem 1rem 0;
                padding-top: 0.75rem;
            }
            #app-container.sidebar-collapsed #sidebar .sidebar-header img {
                background-color: var(--bg-hover);
                border-radius: 6px;
                padding: 4px;
            }
        }
        /* --- Perbaikan Visibilitas Ikon & Tautan --- */
        /* 1. Atur warna yang lebih gelap dan menonjol untuk ikon yang tidak aktif pada tema terang. */
        [data-theme="light"] .nav-link i {
            color: #4b5563; /* gray-600 */
        }
        /* 2. Pastikan tautan aktif memiliki latar belakang gelap pada tema terang untuk kontras tinggi dengan ikon putih. */
        [data-theme="light"] .nav-link.active,
        [data-theme="light"] .nav-link.active:hover {
            background-color: #065f46; /* Darker green for better contrast with white icon */
            color: rgb(239, 237, 237); /* Pastikan ikon dan teks berwarna putih */
        }
        /* 3. Pastikan warna ikon saat di-hover juga menonjol. */
        [data-theme="light"] .nav-link:hover i {
            color: #1f2937; /* gray-800 */
        }
    </style>
</head>
<body class="bg-[var(--bg-primary)] text-[var(--text-primary)] font-sans antialiased">

    <!-- Toast Notification Container -->
    <div id="toast-notification" class="fixed top-5 right-5 bg-green-600 text-white py-3 px-6 rounded-lg shadow-xl opacity-0 transform translate-y-[-20px] z-[100]">
        <p id="toast-message">Aksi berhasil!</p>
    </div>

    <!-- Login Container -->
    <div id="login-container" class="flex items-center justify-center min-h-screen">
        <div class="w-full max-w-md p-8 space-y-8 bg-[var(--bg-secondary)] rounded-lg shadow-lg">
            <div class="text-center">
                <img id="login-logo" src="assets/logo.png" alt="Logo Hotel" class="mx-auto mb-4 h-17 w-auto">
                <h2 class="text-2xl font-bold text-[var(--text-primary)]">Please Login</h2>
                <p class="mt-2 text-sm text-[var(--text-secondary)]">Enter your credentials to continue</p>
            </div>
            <form id="login-form" class="space-y-6">
                <div>
                    <label for="login-email" class="block text-sm font-medium text-[var(--text-secondary)]">Email</label>
                    <input id="login-email" name="email" type="email" autocomplete="email" required class="w-full px-3 py-2 mt-1 text-[var(--text-primary)] bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-md focus:ring-[var(--accent)] focus:border-[var(--accent)]" placeholder="your.email@example.com">
                </div>
                <div>
                    <label for="login-password" class="block text-sm font-medium text-[var(--text-secondary)]">Password</label>
                    <div class="relative mt-1">
                        <input id="login-password" name="password" type="password" autocomplete="current-password" required class="w-full px-3 py-2 pr-10 text-[var(--text-primary)] bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-md focus:ring-[var(--accent)] focus:border-[var(--accent)]" placeholder="••••••••">
                        <button type="button" id="toggle-password-visibility" class="absolute inset-y-0 right-0 px-3 flex items-center text-[var(--text-secondary)] hover:text-[var(--text-primary)]">
                            <i data-lucide="eye" class="w-5 h-5"></i>
                        </button>
                    </div>
                </div>
                <p id="login-error" class="text-sm text-red-400 hidden">Invalid email or password.</p>
                <div>
                    <button type="submit" class="w-full px-4 py-2 font-semibold text-white bg-[var(--accent)] rounded-md hover:bg-[var(--accent-hover)] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[var(--accent)] transition-colors">
                        Login
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- App Container -->
    <div id="app-container" class="relative min-h-screen lg:flex hidden">
        <!-- Backdrop for mobile sidebar -->
        <div id="sidebar-backdrop" class="fixed inset-0 bg-black/60 z-20 hidden lg:hidden"></div>
        
        <!-- Sidebar Navigation -->
        <aside id="sidebar" class="bg-[var(--bg-secondary)] text-[var(--text-primary)] w-64 fixed inset-y-0 left-0 transform -translate-x-full lg:h-screen lg:sticky lg:top-0 lg:translate-x-0 transition-transform duration-300 ease-in-out z-30 flex flex-col">
            <div class="p-5 border-b border-[var(--border-color)] flex items-center space-x-4 sidebar-header">
                <img id="sidebar-logo" src="assets/logo.png" alt="Logo Hotel" class="h-13

                 w-auto">
            </div>
            <nav class="p-4 flex-1 overflow-y-auto">
                <a href="#" class="nav-link flex items-center px-4 py-3 rounded-lg hover:bg-[var(--bg-hover)] transition-colors duration-200 active" data-target="dashboard">
                    <i data-lucide="layout-dashboard" class="w-5 h-5 mr-3 flex-shrink-0"></i> <span class="link-text flex-1 whitespace-nowrap">Dashboard</span>
                </a>
                
                <a href="#" class="nav-link flex items-center px-4 py-3 rounded-lg hover:bg-[var(--bg-hover)] transition-colors duration-200" data-target="pelanggan">
                    <i data-lucide="users" class="w-5 h-5 mr-3 flex-shrink-0"></i> <span class="link-text flex-1 whitespace-nowrap">Pelanggan</span>
                </a>
                <a href="#" class="nav-link flex items-center px-4 py-3 rounded-lg hover:bg-[var(--bg-hover)] transition-colors duration-200" data-target="agenda">
                    <i data-lucide="calendar-check" class="w-5 h-5 mr-3 flex-shrink-0"></i> <span class="link-text flex-1 whitespace-nowrap">Agenda Meeting</span>
                </a>
                <a href="#" class="nav-link flex items-center px-4 py-3 rounded-lg hover:bg-[var(--bg-hover)] transition-colors duration-200" data-target="kalender">
                    <i data-lucide="calendar" class="w-5 h-5 mr-3 flex-shrink-0"></i> <span class="link-text flex-1 whitespace-nowrap">Kalender</span>
                </a>
                <div class="mt-4 pt-4 border-t border-[var(--border-color)] sidebar-section-divider">
                    <h3 class="px-4 text-xs font-semibold text-[var(--text-secondary)] uppercase tracking-wider">Booking</h3>
                    <a href="#" class="nav-link flex items-center px-4 py-3 rounded-lg hover:bg-[var(--bg-hover)] transition-colors duration-200" data-target="booking-kamar">
                        <i data-lucide="bed-double" class="w-5 h-5 mr-3 flex-shrink-0"></i> <span class="link-text flex-1 whitespace-nowrap">Booking Kamar</span>
                    </a>
                    <a href="#" class="nav-link flex items-center px-4 py-3 rounded-lg hover:bg-[var(--bg-hover)] transition-colors duration-200" data-target="booking-meeting">
                        <i data-lucide="presentation" class="w-5 h-5 mr-3 flex-shrink-0"></i> <span class="link-text flex-1 whitespace-nowrap">Banquet</span>
                    </a>
                </div>
                <div class="mt-4 pt-4 border-t border-[var(--border-color)] sidebar-section-divider">
                    <h3 class="px-4 text-xs font-semibold text-[var(--text-secondary)] uppercase tracking-wider">Keuangan & Laporan</h3>
                     <a href="#" class="nav-link flex items-center px-4 py-3 rounded-lg hover:bg-[var(--bg-hover)] transition-colors duration-200" data-target="pembayaran">
                        <i data-lucide="credit-card" class="w-5 h-5 mr-3 flex-shrink-0"></i> <span class="link-text flex-1 whitespace-nowrap">Pembayaran</span>
                    </a>
                     <a href="#" class="nav-link flex items-center px-4 py-3 rounded-lg hover:bg-[var(--bg-hover)] transition-colors duration-200" data-target="laporan">
                        <i data-lucide="file-text" class="w-5 h-5 mr-3 flex-shrink-0"></i> <span class="link-text flex-1 whitespace-nowrap">Invoice</span>
                    </a>
                    <a href="#" class="nav-link flex items-center px-4 py-3 rounded-lg hover:bg-[var(--bg-hover)] transition-colors duration-200" data-target="laporan-sales">
                        <i data-lucide="bar-chart-3" class="w-5 h-5 mr-3 flex-shrink-0"></i> <span class="link-text flex-1 whitespace-nowrap">Laporan Sales</span>
                    </a>
                </div>
                <div id="manajemen-menu" class="mt-4 pt-4 border-t border-[var(--border-color)] sidebar-section-divider">
                    <h3 class="px-4 text-xs font-semibold text-[var(--text-secondary)] uppercase tracking-wider">Manajemen</h3>
                    <a href="#" id="nav-manajemen-user" class="nav-link flex items-center px-4 py-3 rounded-lg hover:bg-[var(--bg-hover)] transition-colors duration-200" data-target="manajemen-user"><i data-lucide="user-cog" class="w-5 h-5 mr-3 flex-shrink-0"></i> <span class="link-text flex-1 whitespace-nowrap">User</span></a>
                    <a href="#" id="nav-manajemen-target" class="nav-link flex items-center px-4 py-3 rounded-lg hover:bg-[var(--bg-hover)] transition-colors duration-200" data-target="manajemen-target"><i data-lucide="target" class="w-5 h-5 mr-3 flex-shrink-0"></i> <span class="link-text flex-1 whitespace-nowrap">Target</span></a>
                    <a href="#" id="nav-manajemen-inventaris" class="nav-link flex items-center px-4 py-3 rounded-lg hover:bg-[var(--bg-hover)] transition-colors duration-200" data-target="manajemen-inventaris">
                        <i data-lucide="archive" class="w-5 h-5 mr-3 flex-shrink-0"></i> <span class="link-text flex-1 whitespace-nowrap">Seting Harga</span>
                    </a>
                     <a href="#" id="nav-manajemen-pengaturan" class="nav-link flex items-center px-4 py-3 rounded-lg hover:bg-[var(--bg-hover)] transition-colors duration-200" data-target="manajemen-pengaturan">
                        <i data-lucide="settings" class="w-5 h-5 mr-3 flex-shrink-0"></i> <span class="link-text flex-1 whitespace-nowrap">Pengaturan</span>
                    </a>
                </div>
            </nav>
            <!-- Logout Button -->
            <div class="p-4 mt-auto border-t border-[var(--border-color)]">
                <button id="sidebar-logout-button" class="w-full flex items-center px-4 py-3 rounded-lg text-red-400 hover:bg-red-500/20 hover:text-red-300 transition-colors duration-200">
                    <i data-lucide="log-out" class="w-5 h-5 mr-3 flex-shrink-0"></i> <span class="link-text flex-1 whitespace-nowrap">Logout</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 flex flex-col">
            <header class="bg-[var(--bg-secondary)]/50 backdrop-blur-sm sticky top-0 z-10 p-4 flex justify-between items-center border-b border-[var(--border-color)] flex-shrink-0">
                <div class="flex items-center">
                    <button id="sidebar-toggle" class="p-2 rounded-md hover:bg-[var(--bg-hover)] mr-4">
                        <i data-lucide="menu" class="w-6 h-6"></i>
                    </button>
                    <h2 id="page-title" class="text-lg md:text-xl font-semibold text-[var(--text-primary)]">Dashboard</h2>
                </div>
                <div class="flex items-center space-x-2">
                    <button id="theme-toggle-btn" class="p-2 rounded-full hover:bg-[var(--bg-hover)]" title="Ganti Tema">
                        <i data-lucide="moon" class="w-5 h-5"></i>
                    </button>

                    <div id="notification-container" class="relative hidden">
                        <button id="notification-toggle" class="p-2 rounded-full hover:bg-[var(--bg-hover)] relative">
                            <i data-lucide="bell" class="w-5 h-5"></i>
                            <span id="notification-badge" class="absolute top-1 right-1 block h-2.5 w-2.5 rounded-full bg-red-500 ring-2 ring-[var(--bg-secondary)] hidden"></span>
                        </button>
                        <div id="notification-panel" class="absolute right-0 mt-2 w-80 bg-[var(--bg-secondary)] border border-[var(--border-color)] rounded-md shadow-lg hidden z-20">
                            <div class="p-3 font-semibold border-b border-[var(--border-color)] flex justify-between items-center">
                                <span>Notifikasi</span>
                                <a href="#" id="mark-all-read-btn" class="text-xs font-normal text-blue-400 hover:underline">Tandai semua dibaca</a>
                            </div>
                            <div id="notification-list" class="max-h-80 overflow-y-auto">
                                <!-- Notifications will be rendered here -->
                            </div>
                        </div>
                    </div>
                    <div class="flex items-center space-x-3">
                        <img src="https://placehold.co/40x40/3b82f6/ffffff?text=S" alt="Sales person avatar" class="w-10 h-10 rounded-full">
                        <div>
                            <p id="user-name-display" class="font-semibold text-[var(--text-primary)]">Nama User</p>
                            <p id="user-role-display" class="text-xs text-[var(--text-secondary)]">Role</p>
                    </div>
                </div>
            </header>

            <div class="p-6 md:p-8">
                <!-- Dashboard Content -->
                <section id="dashboard" class="content-section">
                     <div class="space-y-8">
                        <!-- Stat Cards Row -->
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-6">
                            <div class="stat-card" data-color="blue"><div class="flex items-center gap-4"><div class="w-12 h-12 bg-[var(--accent-blue)] rounded-full flex-shrink-0 flex items-center justify-center"><span class="font-bold text-xl text-[var(--accent-content)]">Rp</span></div><p class="text-sm text-[var(--text-secondary)]">Pendapatan Bulan Ini</p></div><p id="dashboard-pendapatan" class="text-center text-2xl lg:text-3xl font-bold text-[var(--text-primary)] mt-2">Rp 0</p></div>
                            <div id="dashboard-piutang-card" class="stat-card cursor-pointer" data-color="yellow"><div class="flex items-center gap-4"><div class="p-3 bg-[var(--accent-yellow)] rounded-full flex-shrink-0"><i data-lucide="trending-down" class="w-6 h-6 text-[var(--accent-content)]"></i></div><p class="text-sm text-[var(--text-secondary)]">Total Piutang</p></div><p id="dashboard-piutang" class="text-center text-2xl lg:text-3xl font-bold text-[var(--text-primary)] mt-2">Rp 0</p></div>
                            <div class="stat-card" data-color="purple"><div class="flex items-center gap-4"><div class="p-3 bg-[var(--accent-purple)] rounded-full flex-shrink-0"><i data-lucide="calendar-check" class="w-6 h-6 text-[var(--accent-content)]"></i></div><p class="text-sm text-[var(--text-secondary)]">Agenda Hari Ini</p></div><p id="dashboard-agenda" class="text-center text-2xl lg:text-3xl font-bold text-[var(--text-primary)] mt-2">0</p></div>
                            <div class="stat-card" data-color="green"><div class="flex items-center gap-4"><div class="p-3 bg-[var(--accent-green)] rounded-full flex-shrink-0"><i data-lucide="book-check" class="w-6 h-6 text-[var(--accent-content)]"></i></div><p class="text-sm text-[var(--text-secondary)]">Booking Bulan Ini</p></div><p id="dashboard-booking" class="text-center text-2xl lg:text-3xl font-bold text-[var(--text-primary)] mt-2">0</p></div>
                            <div class="stat-card" data-color="red"><div class="flex items-center gap-4"><div class="p-3 bg-[var(--accent-red)] rounded-full flex-shrink-0"><i data-lucide="user-plus" class="w-6 h-6 text-[var(--accent-content)]"></i></div><p class="text-sm text-[var(--text-secondary)]">Total Pelanggan</p></div><p id="dashboard-pelanggan" class="text-center text-2xl lg:text-3xl font-bold text-[var(--text-primary)] mt-2">0</p></div>
                        </div>

                        <!-- Charts Row -->
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <div class="bg-[var(--bg-secondary)] p-6 rounded-lg shadow-lg">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-lg font-semibold">Target Sales Bulan Ini <span id="sales-target-display"></span></h3>
                                </div>
                                <div class="relative h-64"><canvas id="salesTargetChart"></canvas></div>
                            </div>
                            <div class="bg-[var(--bg-secondary)] p-6 rounded-lg shadow-lg flex flex-col">
                                <h3 class="text-lg font-semibold mb-4">Agenda Prioritas</h3>
                                <div id="dashboard-agenda-list" class="h-64 space-y-3 overflow-y-auto pr-2 flex-1"></div>
                            </div>
                            <div class="bg-[var(--bg-secondary)] p-6 rounded-lg shadow-lg">
                                <h3 class="text-lg font-semibold mb-4">Pencapaian Target per Segmen</h3>
                                <div class="h-64"><canvas id="segmentTargetChart"></canvas></div>
                            </div>
                            <div class="bg-[var(--bg-secondary)] p-6 rounded-lg shadow-lg">
                                <h3 class="text-lg font-semibold mb-4">Pendapatan per Tipe Booking (Bulan Ini)</h3>
                                <div class="h-64"><canvas id="bookingTypeChart"></canvas></div>
                            </div>
                            <div id="individual-sales-targets" class="bg-[var(--bg-secondary)] p-6 rounded-lg shadow-lg lg:col-span-2">
                               <!-- Individual sales target progress will be rendered here by JS -->
                            </div>
                        </div>
                     </div>
                </section>
                
                <!-- Pelanggan Content -->
                <div id="pelanggan" class="content-section hidden">
                    <div class="bg-[var(--bg-secondary)] p-6 rounded-lg shadow-lg">
                        <div class="flex flex-col sm:flex-row justify-between items-center mb-4 gap-4">
                            <h3 class="text-lg font-semibold">Data Pelanggan</h3>
                            <div class="flex items-center gap-4 w-full sm:w-auto">
                                <div class="relative w-full sm:w-64">
                                    <input type="text" id="pelanggan-search" placeholder="Cari pelanggan..." class="w-full pl-10 pr-4 py-2 border border-[var(--border-color)] rounded-lg bg-[var(--bg-tertiary)] text-[var(--text-primary)] focus:ring-[var(--accent)] focus:border-[var(--accent)]">
                                    <i data-lucide="search" class="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-[var(--text-secondary)]"></i>
                                </div>
                                <button class="bg-[var(--accent)] hover:bg-[var(--accent-hover)] text-white font-bold py-2 px-4 rounded-md flex items-center flex-shrink-0"  onclick="openModal('pelangganModal')"><i data-lucide="plus" class="w-4 h-4 mr-2"></i> Tambah</button>
                            </div>
                        </div>
                        <div id="pelanggan-table-container" class="overflow-x-auto">
                            <!-- Table will be rendered here -->
                        </div>
                    </div>
                </div>
                
                <!-- Agenda Meeting Content -->
                <div id="agenda" class="content-section hidden">
                    <div class="bg-[var(--bg-secondary)] p-6 rounded-lg shadow-lg">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-semibold">Agenda Meeting</h3>
                            <button class="bg-[var(--accent)] hover:bg-[var(--accent-hover)] text-white font-bold py-2 px-4 rounded-md flex items-center" onclick="openAgendaModal()"><i data-lucide="plus" class="w-4 h-4 mr-2"></i> Tambah Agenda</button>
                        </div>
                        <div class="space-y-6">
                            <div>
                                <h4 class="text-md font-semibold text-blue-400 mb-2">Hari Ini</h4>
                                <div id="agenda-hari-ini" class="space-y-3"></div>
                            </div>
                             <div class="border-t border-[var(--border-color)] pt-6">
                                <h4 class="text-md font-semibold text-yellow-400 mb-2">Akan Datang</h4>
                                <div id="agenda-akan-datang" class="space-y-3"></div>
                            </div>
                             <div class="border-t border-[var(--border-color)] pt-6">
                                <h4 class="text-md font-semibold text-gray-500 mb-2">Selesai</h4>
                                <div id="agenda-selesai" class="space-y-3"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Calendar Content -->
                <div id="kalender" class="content-section hidden">
                    <div class="bg-[var(--bg-secondary)] p-6 rounded-lg shadow-lg">
                        <div id='calendar-container'></div>
                    </div>
                </div>

                <!-- Booking Kamar Content -->
                <div id="booking-kamar" class="content-section hidden">
                    <div class="bg-[var(--bg-secondary)] p-6 rounded-lg shadow-lg">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-lg font-semibold">Buat Booking Kamar Baru</h3>
                            <button type="button" id="new-booking-btn" class="bg-[var(--bg-tertiary)] hover:bg-[var(--bg-hover)] text-[var(--text-primary)] font-bold py-2 px-4 rounded-md flex items-center text-sm">
                                <i data-lucide="plus" class="w-4 h-4 mr-2"></i> Booking Baru
                            </button>
                        </div>
                        <form id="formBookingKamar" class="space-y-6">
                            <div class="p-4 border border-[var(--border-color)] rounded-lg space-y-4">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label for="bk-pelanggan" class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Pilih Pelanggan</label>
                                        <select id="bk-pelanggan" class="w-full bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-md px-3 py-2 text-[var(--text-primary)]" required>
                                            <option value="">-- Pilih --</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Segmentasi Pelanggan</label>
                                        <input type="text" id="bk-segmentasi-display" readonly class="w-full bg-[var(--bg-primary)] border-none rounded-md px-3 py-2 text-[var(--text-primary)] font-medium">
                                    </div>
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div><label for="bk-checkin" class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Tanggal Check-in</label><input type="date" id="bk-checkin" class="w-full bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-md px-3 py-2 text-[var(--text-primary)]" required></div>
                                    <div><label for="bk-checkout" class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Tanggal Check-out</label><input type="date" id="bk-checkout" class="w-full bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-md px-3 py-2 text-[var(--text-primary)]" required></div>
                                </div>
                            </div>
                            
                            <!-- Room rows container -->
                            <div id="room-rows-container" class="space-y-4">
                                <!-- Room row template -->
                                <div class="room-row grid grid-cols-1 md:grid-cols-7 gap-4 items-end p-4 border border-[var(--border-color)] rounded-lg bg-[var(--bg-primary)]/50">
                                    <div class="md:col-span-2">
                                        <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Tipe Kamar</label>
                                        <select name="bk-tipe-kamar" class="w-full bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-md px-3 py-2 text-[var(--text-primary)]" required>
                                            <option value="">-- Pilih --</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Harga/Malam</label>
                                        <input type="text" name="bk-harga-kamar-display" value="-" readonly class="w-full bg-[var(--bg-secondary)] border-none rounded-md px-3 py-2 text-[var(--text-primary)] text-center font-medium">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Paket</label>
                                        <select name="bk-paket" class="w-full bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-md px-3 py-2 text-[var(--text-primary)]">
                                            <option value="room_only">Room Only</option>
                                            <option value="breakfast">With Breakfast</option>
                                        </select>
                                    </div>
                                     <div>
                                        <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Tamu</label>
                                        <input type="number" name="bk-jumlah-tamu" value="1" min="1" class="w-full bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-md px-3 py-2 text-[var(--text-primary)]" required>
                                    </div>
                                     <div>
                                        <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Jml. Kamar</label>
                                        <input type="number" name="bk-jumlah-kamar" value="1" min="1" class="w-full bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-md px-3 py-2 text-[var(--text-primary)]" required>
                                    </div>
                                    <div class="flex justify-end">
                                        <button type="button" class="remove-room-row-btn p-2 text-red-500 hover:text-red-400 rounded-full hover:bg-[var(--bg-hover)] transition-colors hidden">
                                            <i data-lucide="trash-2" class="w-5 h-5"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Add row button -->
                            <div>
                                <button type="button" id="add-room-row-btn" class="w-full px-4 py-2 text-sm font-semibold text-white bg-[var(--accent)] rounded-lg shadow-md hover:bg-[var(--accent-hover)] hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[var(--accent)] transition-all duration-300 ease-in-out flex items-center justify-center">
                                    <i data-lucide="plus-circle" class="w-5 h-5 mr-2"></i> Tambah Tipe Kamar Lain
                                </button>
                            </div>
                            
                            <div class="border-t border-[var(--border-color)] mt-6 pt-4">
                                <div class="flex justify-between items-center text-sm text-[var(--text-secondary)]">
                                    <span>Subtotal</span>
                                    <span id="bk-subtotal">Rp 0</span>
                                </div>
                                <div class="flex justify-between items-center text-sm text-[var(--text-secondary)]">
                                    <span id="bk-tax-label">Pajak & Layanan (21%)</span>
                                    <span id="bk-tax">Rp 0</span>
                                </div>
                                <div class="flex justify-between items-center mt-2 pt-2 border-t border-dashed border-[var(--border-color)]">
                                    <span class="text-lg font-semibold">Total Harga:</span>
                                    <span id="bk-total-harga" class="text-xl md:text-2xl font-bold text-[var(--accent)]">Rp 0</span>
                                </div>
                            </div>
                            <div class="pt-6 flex justify-between items-center">
                                <div id="booking-actions-container" class="space-x-4 hidden">
                                    <button type="button" id="print-confirmation-btn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-md flex items-center">
                                        <i data-lucide="check-circle" class="w-4 h-4 mr-2"></i> Print Surat Konfirmasi
                                    </button>
                                </div>
                                <button type="submit" class="bg-[var(--accent)] hover:bg-[var(--accent-hover)] text-white font-bold py-2 px-6 rounded-md flex items-center ml-auto">
                                    <i data-lucide="save" class="w-4 h-4 mr-2"></i> Simpan Booking
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Booking Ruang Meeting Content -->
                <div id="booking-meeting" class="content-section hidden">
                    <div class="bg-[var(--bg-secondary)] p-6 rounded-lg shadow-lg">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-lg font-semibold">Buat Booking Ruang Meeting Baru</h3>
                            <button type="button" id="new-meeting-booking-btn" class="bg-[var(--bg-tertiary)] hover:bg-[var(--bg-hover)] text-[var(--text-primary)] font-bold py-2 px-4 rounded-md flex items-center text-sm">
                                <i data-lucide="plus" class="w-4 h-4 mr-2"></i> Booking Baru
                            </button>
                        </div>
                        <form id="formBookingMeeting" class="space-y-4">
                            <div><label for="bm-pelanggan" class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Pilih Pelanggan</label><select id="bm-pelanggan" class="w-full bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-md px-3 py-2 text-[var(--text-primary)]" required><option value="">-- Pilih --</option></select></div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div><label for="bm-tanggal-mulai" class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Tanggal Mulai</label><input type="date" id="bm-tanggal-mulai" class="w-full bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-md px-3 py-2 text-[var(--text-primary)]" required></div>
                                <div><label for="bm-tanggal-berakhir" class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Tanggal Berakhir</label><input type="date" id="bm-tanggal-berakhir" class="w-full bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-md px-3 py-2 text-[var(--text-primary)]" required></div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div><label for="bm-jam-mulai" class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Jam Mulai</label><input type="time" id="bm-jam-mulai" class="w-full bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-md px-3 py-2 text-[var(--text-primary)]" required></div>
                                <div><label for="bm-jam-berakhir" class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Jam Berakhir</label><input type="time" id="bm-jam-berakhir" class="w-full bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-md px-3 py-2 text-[var(--text-primary)]" required></div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div><label for="bm-paket" class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Paket Meeting</label><select id="bm-paket" class="w-full bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-md px-3 py-2 text-[var(--text-primary)]" required><option value="">-- Pilih --</option></select></div>
                                <div><label for="bm-harga-paket" class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Harga per Pax / Paket</label><input type="text" id="bm-harga-paket" value="Rp 0" readonly class="w-full bg-[var(--bg-primary)] border border-[var(--border-color)] rounded-md px-3 py-2 text-[var(--text-primary)]"></div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div><label for="bm-tipe-ruang" class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Tipe Ruang Meeting</label><select id="bm-tipe-ruang" class="w-full bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-md px-3 py-2 text-[var(--text-primary)]" required><option value="">-- Pilih --</option></select></div>
                                <div><label for="bm-jumlah-pax" class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Jumlah Pax</label><input type="number" id="bm-jumlah-pax" value="10" min="1" class="w-full bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-md px-3 py-2 text-[var(--text-primary)]" required></div>
                            </div>
                            <div><label for="bm-notes" class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Note Additional</label><textarea id="bm-notes" rows="3" class="w-full bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-md px-3 py-2 text-[var(--text-primary)]" placeholder="Contoh: Butuh proyektor tambahan..."></textarea></div>
                            <div class="border-t border-[var(--border-color)] mt-6 pt-4">
                                <div class="flex justify-between items-center text-sm text-[var(--text-secondary)]">
                                    <span>Subtotal</span>
                                    <span id="bm-subtotal">Rp 0</span>
                                </div>
                                <div class="flex justify-between items-center text-sm text-[var(--text-secondary)]">
                                    <span id="bm-tax-label">Pajak & Layanan (21%)</span>
                                    <span id="bm-tax">Rp 0</span>
                                </div>
                                <div class="flex justify-between items-center mt-2 pt-2 border-t border-dashed border-[var(--border-color)]">
                                    <span class="text-lg font-semibold">Total Harga:</span>
                                    <span id="bm-total-harga" class="text-xl md:text-2xl font-bold text-[var(--accent)]">Rp 0</span>
                                </div>
                            </div>
                            <div class="pt-6 flex justify-between items-center">
                                <div id="meeting-booking-actions-container" class="space-x-4 hidden">
                                    <button type="button" id="print-meeting-confirmation-btn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-md flex items-center">
                                        <i data-lucide="check-circle" class="w-4 h-4 mr-2"></i> Print Surat Konfirmasi
                                    </button>
                                </div>
                                <button type="submit" class="bg-[var(--accent)] hover:bg-[var(--accent-hover)] text-white font-bold py-2 px-6 rounded-md flex items-center ml-auto">
                                    <i data-lucide="save" class="w-4 h-4 mr-2"></i> Simpan Booking
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Manajemen User Content -->
                <div id="manajemen-user" class="content-section hidden">
                    <div class="bg-[var(--bg-secondary)] p-6 rounded-lg shadow-lg">
                        <h3 class="text-lg font-semibold mb-4">Manajemen User & Role</h3>
                        <!-- Tabs -->
                        <div class="border-b border-[var(--border-color)]">
                            <nav class="flex space-x-2" aria-label="Tabs">
                                <button class="user-tab-button tab-button active" data-target="tab-daftar-user">Daftar User</button>
                                <button class="user-tab-button tab-button" data-target="tab-pengaturan-role">Pengaturan Role</button>
                            </nav>
                        </div>
                        <!-- Tab Content -->
                        <div id="tab-daftar-user" class="user-tab-content py-6">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-lg font-semibold">Daftar User Terdaftar</h3>
                                <button class="bg-[var(--accent)] hover:bg-[var(--accent-hover)] text-white font-bold py-2 px-4 rounded-md flex items-center" onclick="openUserModal()"><i data-lucide="plus" class="w-4 h-4 mr-2"></i> Tambah User</button>
                            </div>
                            <div id="user-table-container" class="overflow-x-auto">
                               <!-- User table will be rendered here -->
                            </div>
                        </div>
                        <div id="tab-pengaturan-role" class="user-tab-content hidden py-6">
                            <form id="formRoleSettings">
                                <div id="role-settings-container" class="space-y-6">
                                    <!-- Role settings will be rendered here -->
                                </div>
                                <div class="pt-6 flex justify-end border-t border-[var(--border-color)] mt-6">
                                    <button type="submit" class="bg-[var(--accent)] hover:bg-[var(--accent-hover)] text-white font-bold py-2 px-6 rounded-md flex items-center">
                                        <i data-lucide="save" class="w-4 h-4 mr-2"></i> Simpan Hak Akses
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                
                <!-- Manajemen Inventaris Content (New Tabbed Layout) -->
                <div id="manajemen-inventaris" class="content-section hidden">
                    <div class="bg-[var(--bg-secondary)] p-6 rounded-lg shadow-lg">
                        <h3 class="text-lg font-semibold mb-4">Manajemen Inventaris & Harga</h3>
                        <!-- Tabs -->
                        <div class="border-b border-[var(--border-color)]">
                            <nav class="flex space-x-2" aria-label="Tabs">
                                <button class="inventory-tab-button tab-button active" data-target="tab-kamar">Tipe Kamar</button>
                                <button class="inventory-tab-button tab-button" data-target="tab-ruang-meeting">Ruang Meeting</button>
                                <button class="inventory-tab-button tab-button" data-target="tab-paket-meeting">Paket Meeting</button>
                            </nav>
                        </div>
                        <!-- Tab Content -->
                        <div id="tab-kamar" class="inventory-tab-content py-6">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-lg font-semibold">Detail Harga Tipe Kamar</h3>
                                <button class="bg-[var(--accent)] hover:bg-[var(--accent-hover)] text-white font-bold py-2 px-4 rounded-md flex items-center text-sm" onclick="openKamarModal()"><i data-lucide="plus" class="w-4 h-4 mr-2"></i> Tambah</button>
                            </div>
                            <div id="inventaris-kamar-table-container" class="overflow-x-auto"></div>
                        </div>
                        <div id="tab-ruang-meeting" class="inventory-tab-content hidden py-6">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-lg font-semibold">Detail Harga Ruang Meeting</h3>
                                <button class="bg-[var(--accent)] hover:bg-[var(--accent-hover)] text-white font-bold py-2 px-4 rounded-md flex items-center text-sm" onclick="openMeetingRoomModal()"><i data-lucide="plus" class="w-4 h-4 mr-2"></i> Tambah</button>
                            </div>
                            <div id="inventaris-meeting-table-container"></div>
                        </div>
                        <div id="tab-paket-meeting" class="inventory-tab-content hidden py-6">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-lg font-semibold">Detail Harga Paket Meeting</h3>
                                <button class="bg-[var(--accent)] hover:bg-[var(--accent-hover)] text-white font-bold py-2 px-4 rounded-md flex items-center text-sm" onclick="openPaketMeetingModal()"><i data-lucide="plus" class="w-4 h-4 mr-2"></i> Tambah</button>
                            </div>
                            <div id="inventaris-paket-meeting-table-container"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Manajemen Pengaturan Content -->
                <div id="manajemen-pengaturan" class="content-section hidden">
                    <div class="bg-[var(--bg-secondary)] p-6 rounded-lg shadow-lg max-w-4xl mx-auto">
                        <h3 class="text-lg font-semibold mb-4">Pengaturan</h3>
                        <!-- Tabs -->
                        <div class="border-b border-[var(--border-color)]">
                            <nav class="flex space-x-2" aria-label="Tabs">
                                <button class="settings-tab-button tab-button active" data-target="tab-profil">Profil Perusahaan</button>
                                <button class="settings-tab-button tab-button" data-target="tab-pajak">Pajak & Pelayanan</button>
                                <button class="settings-tab-button tab-button" data-target="tab-agenda-type">Tipe Agenda</button>
                            </nav>
                        </div>
                        <!-- Tab Content -->
                        <div id="tab-profil" class="tab-content py-6">
                             <form id="formProfilPerusahaan">
                                 <div class="space-y-6">
                                     <div>
                                         <label for="profil-nama" class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Nama Perusahaan</label>
                                         <input type="text" id="profil-nama" placeholder="Nama Hotel atau Perusahaan Anda" class="w-full bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-md px-3 py-2 text-[var(--text-primary)]">
                                     </div>
                                     <div>
                                         <label for="profil-telepon" class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Nomor Telepon Perusahaan</label>
                                         <input type="tel" id="profil-telepon" placeholder="Nomor telepon yang bisa dihubungi" class="w-full bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-md px-3 py-2 text-[var(--text-primary)]">
                                     </div>
                                     <div>
                                         <label for="profil-alamat" class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Alamat Perusahaan</label>
                                         <textarea id="profil-alamat" rows="3" placeholder="Alamat lengkap perusahaan Anda" class="w-full bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-md px-3 py-2 text-[var(--text-primary)]"></textarea>
                                     </div>
                                     <div>
                                         <label for="profil-logo-upload" class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Logo Perusahaan</label>
                                         <input type="file" id="profil-logo-upload" accept="image/*" class="w-full text-sm text-[var(--text-secondary)] file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-[var(--accent)] file:text-white hover:file:bg-[var(--accent-hover)]">
                                         <div class="mt-4"><p class="text-sm text-[var(--text-secondary)] mb-2">Preview Logo:</p><img id="profil-logo-preview" src="assets/logo.png" alt="Preview Logo" class="mt-2 rounded-lg max-h-20 bg-white p-2 border border-[var(--border-color)]"></div>
                                     </div>
                                 </div>
                                 <div class="pt-6 flex justify-end"><button type="submit" class="bg-[var(--accent)] hover:bg-[var(--accent-hover)] text-white font-bold py-2 px-6 rounded-md flex items-center"><i data-lucide="save" class="w-4 h-4 mr-2"></i> Simpan Profil</button></div>
                             </form>
                        </div>
                        <div id="tab-pajak" class="tab-content py-6 hidden">
                             <form id="formPajak">
                                 <div class="space-y-4">
                                     <div>
                                         <label for="tax-service-percentage" class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Persentase Pajak & Pelayanan (%)</label>
                                         <input type="number" id="tax-service-percentage" step="0.1" min="0" class="w-full max-w-xs bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-md px-3 py-2 text-[var(--text-primary)]" required>
                                     </div>
                                     <div>
                                         <label for="invoice-payment-notes" class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Catatan Pembayaran di Invoice</label>
                                         <textarea id="invoice-payment-notes" rows="4" class="w-full bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-md px-3 py-2 text-[var(--text-primary)]" placeholder="Contoh: Bank ABC, No. Rek: 123-456-7890..."></textarea>
                                     </div>
                                 </div>
                                 <div class="pt-6 flex justify-end">
                                     <button type="submit" class="bg-[var(--accent)] hover:bg-[var(--accent-hover)] text-white font-bold py-2 px-6 rounded-md flex items-center">
                                         <i data-lucide="save" class="w-4 h-4 mr-2"></i> Simpan
                                     </button>
                                 </div>
                             </form>
                        </div>
                        <div id="tab-agenda-type" class="tab-content py-6 hidden">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-lg font-semibold">Manajemen Tipe Agenda Meeting</h3>
                                <button class="bg-[var(--accent)] hover:bg-[var(--accent-hover)] text-white font-bold py-2 px-4 rounded-md flex items-center text-sm" onclick="openAgendaTypeModal()">
                                    <i data-lucide="plus" class="w-4 h-4 mr-2"></i> Tambah Tipe
                                </button>
                            </div>
                            <div id="pengaturan-agenda-table-container" class="overflow-x-auto">
                                <!-- Agenda type table will be rendered here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Manajemen Target Content -->
                <div id="manajemen-target" class="content-section hidden">
                    <div class="bg-[var(--bg-secondary)] p-6 rounded-lg shadow-lg max-w-2xl mx-auto">
                        <h3 class="text-lg sm:text-xl font-semibold mb-6">Set Target Penjualan Bulanan</h3>
                        <form id="targetForm" class="space-y-4">
                            <div class="grid grid-cols-2 gap-4">
                                <div><label for="target-bulan" class="block text-sm text-[var(--text-secondary)] mb-2">Bulan</label><select id="target-bulan" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2"></select></div>
                                <div><label for="target-tahun" class="block text-sm text-[var(--text-secondary)] mb-2">Tahun</label><select id="target-tahun" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2"></select></div>
                            </div>
                            <div>
                                <label for="sales-target-input" class="block text-sm text-[var(--text-secondary)] mb-2">Target Keseluruhan Tim (dalam Juta Rupiah)</label>
                                <input type="number" id="sales-target-input" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" placeholder="Contoh: 200" required>
                            </div>
                            <div class="border-t border-[var(--border-color)] pt-4 mt-4">
                                <h4 class="text-md font-semibold mb-4">Target Individual Sales</h4>
                                <div id="sales-target-list" class="space-y-3 max-h-40 overflow-y-auto pr-2">
                                    <!-- Sales target inputs will be rendered here by JS -->
                                </div>
                            </div>
                            <div class="border-t border-[var(--border-color)] pt-4 mt-4">
                                <h4 class="text-md font-semibold mb-4">Target per Segmen (dalam Juta Rupiah)</h4>
                                <div id="segment-target-list" class="space-y-3">
                                    <!-- Segment target inputs will be rendered here by JS -->
                                </div>
                            </div>
                            <div class="flex justify-end space-x-4 pt-4"><button type="submit" class="px-6 py-2 rounded-md bg-[var(--accent)] hover:bg-[var(--accent-hover)] text-white font-semibold">Simpan Target</button></div>
                        </form>
                    </div>
                </div>

                <!-- Pembayaran Content -->
                <div id="pembayaran" class="content-section hidden">
                    <div class="bg-[var(--bg-secondary)] p-6 rounded-lg shadow-lg space-y-8">
                        <div>
                            <h3 class="text-lg font-semibold mb-4">Ringkasan Piutang</h3>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="bg-[var(--bg-tertiary)] p-4 rounded-lg"><p class="text-sm text-[var(--text-secondary)]">Total Tagihan (Piutang)</p><p id="pembayaran-total-tagihan" class="text-xl font-bold text-[var(--text-primary)]">Rp 0</p></div>
                                <div class="bg-[var(--bg-tertiary)] p-4 rounded-lg"><p class="text-sm text-[var(--text-secondary)]">Total Sisa Tagihan (Piutang)</p><p id="pembayaran-total-sisa" class="text-xl font-bold text-red-500">Rp 0</p></div>
                                <div class="bg-[var(--bg-tertiary)] p-4 rounded-lg"><p class="text-sm text-[var(--text-secondary)]">Jumlah Transaksi (Piutang)</p><p id="pembayaran-total-transaksi" class="text-xl font-bold text-[var(--text-primary)]">0</p></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex flex-col sm:flex-row justify-between items-center mb-4 gap-4">
                                <h3 class="text-lg font-semibold">Rincian Piutang</h3>
                                <div class="flex items-center gap-2 w-full sm:w-auto flex-wrap justify-end">
                                    <select id="pembayaran-sales-filter" class="pl-4 pr-8 py-2 border border-[var(--border-color)] rounded-lg bg-[var(--bg-tertiary)] text-[var(--text-primary)] focus:ring-[var(--accent)] focus:border-[var(--accent)] text-sm">
                                        <!-- Options populated by JS -->
                                    </select>
                                     <div class="relative w-full sm:w-64">
                                        <input type="text" id="pembayaran-search" placeholder="Cari ID atau pelanggan..." class="w-full pl-10 pr-4 py-2 border border-[var(--border-color)] rounded-lg bg-[var(--bg-tertiary)] text-[var(--text-primary)] focus:ring-[var(--accent)] focus:border-[var(--accent)]">
                                        <i data-lucide="search" class="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-[var(--text-secondary)]"></i>
                                    </div>
                                    <button id="print-piutang-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md flex items-center flex-shrink-0 text-sm"><i data-lucide="printer" class="w-4 h-4 mr-2"></i> Cetak Laporan</button>
                                </div>
                            </div>
                            <div id="pembayaran-table-container" class="overflow-x-auto">
                                <!-- Payment table will be rendered here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Laporan & Invoice Content -->
                <div id="laporan" class="content-section hidden">
                    <div class="bg-[var(--bg-secondary)] p-6 rounded-lg shadow-lg space-y-8">
                        <div>
                            <h3 class="text-lg font-semibold mb-4">Ringkasan Semua Transaksi</h3>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="bg-[var(--bg-tertiary)] p-4 rounded-lg"><p class="text-sm text-[var(--text-secondary)]">Total Pendapatan</p><p id="laporan-total-pendapatan" class="text-xl font-bold text-[var(--text-primary)]">Rp 0</p></div>
                                <div class="bg-[var(--bg-tertiary)] p-4 rounded-lg"><p class="text-sm text-[var(--text-secondary)]">Total Sudah Dibayar</p><p id="laporan-total-dibayar" class="text-xl font-bold text-green-500">Rp 0</p></div>
                                <div class="bg-[var(--bg-tertiary)] p-4 rounded-lg"><p class="text-sm text-[var(--text-secondary)]">Total Sisa Tagihan</p><p id="laporan-total-sisa" class="text-xl font-bold text-red-500">Rp 0</p></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex flex-col sm:flex-row justify-between items-center mb-4 gap-4">
                                <h3 class="text-lg font-semibold">Rincian Transaksi</h3>
                                <div class="relative w-full sm:w-64">
                                    <input type="text" id="laporan-search" placeholder="Cari ID atau pelanggan..." class="w-full pl-10 pr-4 py-2 border border-[var(--border-color)] rounded-lg bg-[var(--bg-tertiary)] text-[var(--text-primary)] focus:ring-[var(--accent)] focus:border-[var(--accent)]">
                                    <i data-lucide="search" class="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-[var(--text-secondary)]"></i>
                                </div>
                            </div>
                            <div id="laporan-table-container" class="overflow-x-auto">
                                <!-- Reports table will be rendered here -->
                            </div>
                        </div>
                    </div>
                </div>
                 <!-- Laporan Sales Content -->
                <div id="laporan-sales" class="content-section hidden">
                    <div class="bg-[var(--bg-secondary)] p-6 rounded-lg shadow-lg">
                        <h3 class="text-lg font-semibold mb-4">Laporan Pencapaian Sales</h3>
                        <div class="bg-[var(--bg-tertiary)]/50 p-4 rounded-lg grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 items-end gap-4 mb-6">
                            <div class="flex-1 w-full">
                                <label for="report-start-date" class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Tanggal Mulai</label>
                                <input type="date" id="report-start-date" class="w-full bg-[var(--bg-secondary)] border border-[var(--border-color)] rounded-md px-3 py-2 text-[var(--text-primary)]">
                            </div>
                            <div class="flex-1 w-full">
                                <label for="report-end-date" class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Tanggal Selesai</label>
                                <input type="date" id="report-end-date" class="w-full bg-[var(--bg-secondary)] border border-[var(--border-color)] rounded-md px-3 py-2 text-[var(--text-primary)]">
                            </div>
                            <div class="flex-1 w-full">
                                <label for="report-sales-filter" class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Filter Sales</label>
                                <select id="report-sales-filter" class="w-full bg-[var(--bg-secondary)] border border-[var(--border-color)] rounded-md px-3 py-2 text-[var(--text-primary)]"></select>
                            </div>
                            <div>
                                <button id="generate-sales-report-btn" class="w-full md:w-auto bg-[var(--accent)] hover:bg-[var(--accent-hover)] text-white font-bold py-2 px-6 rounded-md flex items-center justify-center">
                                    <i data-lucide="play" class="w-4 h-4 mr-2"></i> Buat Laporan
                                </button>
                            </div>
                        </div>

                        <!-- Sales Report Summary -->
                        <div id="sales-report-summary" class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 hidden">
                            <div class="bg-[var(--bg-tertiary)] p-4 rounded-lg">
                                <p class="text-sm text-[var(--text-secondary)]">Total Pendapatan</p>
                                <p id="sales-report-total-revenue" class="text-xl font-bold text-[var(--text-primary)]">Rp 0</p>
                            </div>
                            <div class="bg-[var(--bg-tertiary)] p-4 rounded-lg">
                                <p class="text-sm text-[var(--text-secondary)]">Total Booking</p>
                                <p id="sales-report-total-bookings" class="text-xl font-bold text-[var(--text-primary)]">0</p>
                            </div>
                            <div class="bg-[var(--bg-tertiary)] p-4 rounded-lg">
                                <p class="text-sm text-[var(--text-secondary)]">Total Agenda</p>
                                <p id="sales-report-total-agendas" class="text-xl font-bold text-[var(--text-primary)]">0</p>
                            </div>
                        </div>

                        <div id="sales-report-actions" class="flex items-center gap-4 mb-4 hidden">
                             <button id="print-sales-report-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md flex items-center text-sm">
                                <i data-lucide="printer" class="w-4 h-4 mr-2"></i> Print PDF
                            </button>
                            <button id="export-sales-report-btn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-md flex items-center text-sm">
                                <i data-lucide="sheet" class="w-4 h-4 mr-2"></i> Export Excel
                            </button>
                        </div>

                        <div id="sales-report-container" class="overflow-x-auto">
                            <!-- Sales report table will be rendered here -->
                        </div>
                        
                        <!-- Agenda Report Container -->
                        <div id="sales-agenda-report-section" class="mt-8 hidden">
                             <h4 class="text-lg font-semibold mb-4 flex items-center"><i data-lucide="calendar-check" class="w-5 h-5 mr-2 text-blue-400"></i> Laporan Detail Agenda Meeting</h4>
                             <div id="sales-agenda-report-container" class="overflow-x-auto">
                                <!-- Agenda report table will be rendered here -->
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modals -->
    <!-- (All modal HTML remains the same) -->
    <div id="pelangganModal" class="modal fixed inset-0 bg-black bg-opacity-70 z-50 hidden items-center justify-center opacity-0" onclick="closeModal('pelangganModal')">
        <div class="modal-content bg-[var(--bg-secondary)] rounded-lg shadow-xl p-8 w-full max-w-md transform scale-95" onclick="event.stopPropagation()">
            <h3 id="pelangganModalTitle" class="text-lg sm:text-xl font-semibold mb-6">Tambah Pelanggan Baru</h3>
            <form id="formTambahPelanggan" class="space-y-4">
                <input type="hidden" id="pelanggan-id">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div><label class="block text-sm text-[var(--text-secondary)] mb-2">Nama Lengkap</label><input type="text" id="pelanggan-nama" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required></div>
                    <div><label class="block text-sm text-[var(--text-secondary)] mb-2">Perusahaan (Opsional)</label><input type="text" id="pelanggan-perusahaan" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2"></div>
                </div>
                <div><label class="block text-sm text-[var(--text-secondary)] mb-2">Segmentasi</label><select id="pelanggan-segmentasi" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required><option value="">-- Pilih --</option><option value="Individual">Individual</option><option value="Corporate">Corporate</option><option value="Travel Agent">Travel Agent</option><option value="Government">Government</option></select></div>
                <div><label class="block text-sm text-[var(--text-secondary)] mb-2">Alamat</label><textarea id="pelanggan-alamat" rows="2" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2"></textarea></div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div><label class="block text-sm text-[var(--text-secondary)] mb-2">Email</label><input type="email" id="pelanggan-email" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required></div>
                    <div><label class="block text-sm text-[var(--text-secondary)] mb-2">Nomor Telepon</label><input type="tel" id="pelanggan-telepon" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required></div>
                </div>
                <div class="flex justify-end space-x-4 pt-6">
                    <button type="button" class="px-4 py-2 rounded-md text-[var(--text-primary)] hover:bg-[var(--bg-hover)]" onclick="closeModal('pelangganModal')">Batal</button>
                    <button type="submit" class="px-6 py-2 rounded-md bg-[var(--accent)] hover:bg-[var(--accent-hover)] text-white font-semibold">Simpan</button>
                </div>
            </form>
        </div>
    </div>
    
    <div id="kamarModal" class="modal fixed inset-0 bg-black bg-opacity-70 z-50 hidden items-center justify-center opacity-0" onclick="closeModal('kamarModal')">
        <div class="modal-content bg-[var(--bg-secondary)] rounded-lg shadow-xl p-8 w-full max-w-lg transform scale-95" onclick="event.stopPropagation()">
            <h3 id="kamarModalTitle" class="text-lg sm:text-xl font-semibold mb-6">Tambah Tipe Kamar</h3>
            <form id="formKamar" class="space-y-4">
                <input type="hidden" id="kamar-id">
                <div>
                    <label class="block text-sm text-[var(--text-secondary)] mb-2">Nama Tipe Kamar</label>
                    <input type="text" id="kamar-nama" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required>
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm text-[var(--text-secondary)] mb-2">Harga Individual</label>
                        <input type="number" id="kamar-harga-individual" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required>
                    </div>
                    <div>
                        <label class="block text-sm text-[var(--text-secondary)] mb-2">Harga Corporate</label>
                        <input type="number" id="kamar-harga-corporate" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required>
                    </div>
                    <div>
                        <label class="block text-sm text-[var(--text-secondary)] mb-2">Harga Travel Agent</label>
                        <input type="number" id="kamar-harga-travel" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required>
                    </div>
                    <div>
                        <label class="block text-sm text-[var(--text-secondary)] mb-2">Harga Government</label>
                        <input type="number" id="kamar-harga-government" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required>
                    </div>
                </div>
                <div>
                    <label class="block text-sm text-[var(--text-secondary)] mb-2">Harga Sarapan per Orang</label>
                    <input type="number" id="kamar-harga-sarapan" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required>
                </div>
                <div class="flex justify-end space-x-4 pt-6">
                    <button type="button" class="px-4 py-2 rounded-md text-[var(--text-primary)] hover:bg-[var(--bg-hover)]" onclick="closeModal('kamarModal')">Batal</button>
                    <button type="submit" class="px-6 py-2 rounded-md bg-[var(--accent)] hover:bg-[var(--accent-hover)] text-white font-semibold">Simpan</button>
                </div>
            </form>
        </div>
    </div>

    <div id="meetingRoomModal" class="modal fixed inset-0 bg-black bg-opacity-70 z-50 hidden items-center justify-center opacity-0" onclick="closeModal('meetingRoomModal')"><div class="modal-content bg-[var(--bg-secondary)] rounded-lg shadow-xl p-8 w-full max-w-md transform scale-95" onclick="event.stopPropagation()"><h3 id="meetingRoomModalTitle" class="text-lg sm:text-xl font-semibold mb-6">Tambah Ruang Meeting</h3><form id="formMeetingRoom" class="space-y-4"><input type="hidden" id="meeting-room-id"><div><label class="block text-sm text-[var(--text-secondary)] mb-2">Nama Ruang Meeting</label><input type="text" id="meeting-room-nama" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required></div><div><label class="block text-sm text-[var(--text-secondary)] mb-2">Harga Sewa</label><input type="number" id="meeting-room-harga" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required></div><div class="flex justify-end space-x-4 pt-6"><button type="button" class="px-4 py-2 rounded-md text-[var(--text-primary)] hover:bg-[var(--bg-hover)]" onclick="closeModal('meetingRoomModal')">Batal</button><button type="submit" class="px-6 py-2 rounded-md bg-[var(--accent)] hover:bg-[var(--accent-hover)] text-white font-semibold">Simpan</button></div></form></div></div>
    
    <div id="paketMeetingModal" class="modal fixed inset-0 bg-black bg-opacity-70 z-50 hidden items-center justify-center opacity-0" onclick="closeModal('paketMeetingModal')"><div class="modal-content bg-[var(--bg-secondary)] rounded-lg shadow-xl p-8 w-full max-w-md transform scale-95" onclick="event.stopPropagation()"><h3 id="paketMeetingModalTitle" class="text-lg sm:text-xl font-semibold mb-6">Tambah Paket Meeting</h3><form id="formPaketMeeting" class="space-y-4"><input type="hidden" id="paket-meeting-id"><div><label class="block text-sm text-[var(--text-secondary)] mb-2">Nama Paket</label><input type="text" id="paket-meeting-nama" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required></div><div><label class="block text-sm text-[var(--text-secondary)] mb-2">Harga per Pax</label><input type="number" id="paket-meeting-harga" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required></div><div class="flex justify-end space-x-4 pt-6"><button type="button" class="px-4 py-2 rounded-md text-[var(--text-primary)] hover:bg-[var(--bg-hover)]" onclick="closeModal('paketMeetingModal')">Batal</button><button type="submit" class="px-6 py-2 rounded-md bg-[var(--accent)] hover:bg-[var(--accent-hover)] text-white font-semibold">Simpan</button></div></form></div></div>
    
    <!-- Agenda Type Modal -->
    <div id="agendaTypeModal" class="modal fixed inset-0 bg-black bg-opacity-70 z-50 hidden items-center justify-center opacity-0" onclick="closeModal('agendaTypeModal')">
        <div class="modal-content bg-[var(--bg-secondary)] rounded-lg shadow-xl p-8 w-full max-w-md transform scale-95" onclick="event.stopPropagation()">
            <h3 id="agendaTypeModalTitle" class="text-lg sm:text-xl font-semibold mb-6">Tambah Tipe Agenda</h3>
            <form id="formAgendaType" class="space-y-4">
                <input type="hidden" id="agenda-type-id">
                <div><label class="block text-sm text-[var(--text-secondary)] mb-2">Nama Tipe Agenda</label><input type="text" id="agenda-type-nama" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required></div>
                <div class="flex justify-end space-x-4 pt-6">
                    <button type="button" class="px-4 py-2 rounded-md text-[var(--text-primary)] hover:bg-[var(--bg-hover)]" onclick="closeModal('agendaTypeModal')">Batal</button>
                    <button type="submit" class="px-6 py-2 rounded-md bg-[var(--accent)] hover:bg-[var(--accent-hover)] text-white font-semibold">Simpan</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Agenda Modal -->
    <div id="agendaModal" class="modal fixed inset-0 bg-black bg-opacity-70 z-50 hidden items-center justify-center opacity-0" onclick="closeModal('agendaModal')">
        <div class="modal-content bg-[var(--bg-secondary)] rounded-lg shadow-xl w-full max-w-4xl transform scale-95 flex flex-col max-h-[90vh]" onclick="event.stopPropagation()">
            <!-- Modal Header -->
            <div class="p-6 border-b border-[var(--border-color)] flex-shrink-0">
                <h3 id="agendaModalTitle" class="text-lg sm:text-xl font-semibold">Tambah Agenda Baru</h3>
            </div>
            <!-- Modal Body (Scrollable) -->
            <div class="flex-1 overflow-y-auto p-6">
                <form id="formAgenda" class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4">
                    <input type="hidden" id="agenda-id">
                    <!-- Left Column -->
                    <div class="space-y-4">
                        <div><label class="block text-sm text-[var(--text-secondary)] mb-2">Judul Meeting</label><input type="text" id="agenda-judul" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required></div>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4"><div><label class="block text-sm text-[var(--text-secondary)] mb-2">Pelanggan</label><select id="agenda-pelanggan" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required><option value="">-- Pilih --</option></select></div><div><label class="block text-sm text-[var(--text-secondary)] mb-2">Tipe Agenda</label><select id="agenda-tipe" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required><option value="">-- Pilih Tipe --</option></select></div></div>
                        <div><label class="block text-sm text-[var(--text-secondary)] mb-2">Tanggal</label><input type="date" id="agenda-tanggal" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required></div>
                        <div class="grid grid-cols-2 gap-4"><div><label class="block text-sm text-[var(--text-secondary)] mb-2">Jam Mulai</label><input type="time" id="agenda-jam-mulai" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required></div><div><label class="block text-sm text-[var(--text-secondary)] mb-2">Jam Selesai</label><input type="time" id="agenda-jam-selesai" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required></div></div>
                        <div><label class="block text-sm text-[var(--text-secondary)] mb-2">Catatan</label><textarea id="agenda-catatan" rows="4" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2"></textarea></div>
                    </div>
                    <!-- Right Column -->
                    <div class="space-y-4">
                        <label class="block text-sm text-[var(--text-secondary)] mb-2">Lokasi</label>
                        <div class="flex items-center space-x-2 mb-2"><input type="text" id="agenda-lokasi" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" placeholder="Koordinat GPS atau nama tempat"><button type="button" id="get-gps-location" class="p-2 bg-[var(--accent)] rounded-md hover:bg-[var(--accent-hover)]"><i data-lucide="map-pin" class="w-5 h-5 text-white"></i></button></div>
                        <div id="agenda-map-container" class="w-full h-48 bg-[var(--bg-tertiary)] rounded-lg border border-[var(--border-color)]"></div>
                        <div><label class="block text-sm text-[var(--text-secondary)] mb-2">Upload Foto (Opsional)</label><input type="file" id="agenda-foto-upload" accept="image/*" class="w-full text-sm text-[var(--text-secondary)] file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-[var(--accent)] file:text-white hover:file:bg-[var(--accent-hover)]"><img id="agenda-foto-preview" src="#" alt="Preview Foto Agenda" class="mt-4 rounded-lg max-h-40 hidden"></div>
                    </div>
                </form>
            </div>
            <!-- Modal Footer -->
            <div class="p-6 border-t border-[var(--border-color)] flex justify-end space-x-4 flex-shrink-0">
                <button type="button" class="px-4 py-2 rounded-md text-[var(--text-primary)] hover:bg-[var(--bg-hover)]" onclick="closeModal('agendaModal')">Batal</button>
                <button type="submit" form="formAgenda" class="px-6 py-2 rounded-md bg-[var(--accent)] hover:bg-[var(--accent-hover)] text-white font-semibold">Simpan</button>
            </div>
        </div>
    </div>

    <!-- User Modal -->
    <div id="userModal" class="modal fixed inset-0 bg-black bg-opacity-70 z-50 hidden items-center justify-center opacity-0" onclick="closeModal('userModal')"><div class="modal-content bg-[var(--bg-secondary)] rounded-lg shadow-xl p-8 w-full max-w-md transform scale-95" onclick="event.stopPropagation()"><h3 id="userModalTitle" class="text-lg sm:text-xl font-semibold mb-6">Tambah User Baru</h3><form id="formUser" class="space-y-4"><input type="hidden" id="user-id"><div><label class="block text-sm text-[var(--text-secondary)] mb-2">Nama Lengkap</label><input type="text" id="user-nama" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required></div><div><label class="block text-sm text-[var(--text-secondary)] mb-2">Email</label><input type="email" id="user-email" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required></div><div><label class="block text-sm text-[var(--text-secondary)] mb-2">Password</label><input type="password" id="user-password" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" placeholder="Kosongkan jika tidak diubah"></div><div><label class="block text-sm text-[var(--text-secondary)] mb-2">Role</label><select id="user-role" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required><option value="Sales">Sales</option><option value="Accounting">Accounting</option><option value="Manager">Manager</option><option value="Admin">Admin</option></select></div><div class="flex justify-end space-x-4 pt-6"><button type="button" class="px-4 py-2 rounded-md text-[var(--text-primary)] hover:bg-[var(--bg-hover)]" onclick="closeModal('userModal')">Batal</button><button type="submit" class="px-6 py-2 rounded-md bg-[var(--accent)] hover:bg-[var(--accent-hover)] text-white font-semibold">Simpan</button></div></form></div></div>

    <!-- Payment Modal -->

    <div id="paymentModal" class="modal fixed inset-0 bg-black bg-opacity-70 z-50 hidden items-center justify-center opacity-0" onclick="closeModal('paymentModal')">
        <div class="modal-content bg-[var(--bg-secondary)] rounded-lg shadow-xl p-8 w-full max-w-lg transform scale-95" onclick="event.stopPropagation()">
            <h3 class="text-lg sm:text-xl font-semibold mb-2">Input Pembayaran</h3>
            <p class="text-sm text-[var(--text-secondary)] mb-6">Untuk Booking ID: <span id="payment-booking-id" class="font-bold"></span></p>
            <div class="grid grid-cols-4 gap-4 mb-6 text-center">
                <div><p class="text-sm text-[var(--text-secondary)]">Total Tagihan</p><p id="payment-total-tagihan" class="text-lg font-bold"></p></div>
                <div><p class="text-sm text-[var(--text-secondary)]">Dibayar (Verified)</p><p id="payment-sudah-dibayar" class="text-lg font-bold text-green-500"></p></div>
                <div><p class="text-sm text-[var(--text-secondary)]">Menunggu Verifikasi</p><p id="payment-menunggu-verifikasi" class="text-lg font-bold text-yellow-500"></p></div>
                <div><p class="text-sm text-[var(--text-secondary)]">Sisa Tagihan</p><p id="payment-sisa-tagihan" class="text-lg font-bold text-red-500"></p></div>
            </div>
            <form id="formPembayaran" class="space-y-4">
                <input type="hidden" id="payment-booking-id-input">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm text-[var(--text-secondary)] mb-2">Jumlah Pembayaran</label>
                        <input type="number" id="payment-jumlah" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required>
                    </div>
                    <div>
                        <label class="block text-sm text-[var(--text-secondary)] mb-2">Tanggal Pembayaran</label>
                        <input type="date" id="payment-tanggal" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm text-[var(--text-secondary)] mb-2">Metode Pembayaran</label>
                        <select id="payment-metode" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required>
                            <option value="Cash">Cash</option>
                            <option value="Transfer Bank">Transfer Bank</option>
                            <option value="Kartu Kredit">Kartu Kredit</option>
                            <option value="Lainnya">Lainnya</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm text-[var(--text-secondary)] mb-2">Tipe Pembayaran</label>
                        <select id="payment-tipe" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" required>
                            <option value="DP">DP (Down Payment)</option>
                            <option value="Pelunasan">Pelunasan</option>
                        </select>
                    </div>
                </div>
                <div>
                    <label class="block text-sm text-[var(--text-secondary)] mb-2">Catatan (Opsional)</label>
                    <textarea id="payment-catatan" rows="2" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2"></textarea>
                </div>
                <div>
                    <label class="block text-sm text-[var(--text-secondary)] mb-2">Upload Bukti Transfer (Opsional)</label>
                    <input type="file" id="payment-proof-upload" accept="image/*" class="w-full text-sm text-[var(--text-secondary)] file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-[var(--accent)] file:text-white hover:file:bg-[var(--accent-hover)]">
                    <img id="payment-proof-preview" src="#" alt="Preview Bukti Transfer" class="mt-4 rounded-lg max-h-40 hidden">
                </div>
                <div class="flex justify-end space-x-4 pt-6">
                    <button type="button" class="px-4 py-2 rounded-md text-[var(--text-primary)] hover:bg-[var(--bg-hover)]" onclick="closeModal('paymentModal')">Batal</button>
                    <button type="submit" class="px-6 py-2 rounded-md bg-[var(--accent)] hover:bg-[var(--accent-hover)] text-white font-semibold">Simpan Pembayaran</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Verification Modal -->
    <div id="verificationModal" class="modal fixed inset-0 bg-black bg-opacity-70 z-[60] hidden items-center justify-center opacity-0" onclick="closeModal('verificationModal')">
        <div class="modal-content bg-[var(--bg-secondary)] rounded-lg shadow-xl p-8 w-full max-w-lg transform scale-95" onclick="event.stopPropagation()">
            <h3 id="verificationModalTitle" class="text-lg sm:text-xl font-semibold mb-6">Verifikasi Pembayaran</h3>
            <form id="formVerifikasi" class="space-y-4">
                <input type="hidden" id="verification-booking-id">
                <div>
                    <p class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Pilih pembayaran yang akan diverifikasi:</p>
                    <div id="verification-payment-list" class="space-y-2 p-3 bg-[var(--bg-tertiary)] rounded-md max-h-40 overflow-y-auto">
                        <!-- Unverified payments will be listed here -->
                    </div>
                </div>
                <div>
                    <label class="block text-sm text-[var(--text-secondary)] mb-2">Catatan Verifikasi</label>
                    <textarea id="verification-note" rows="3" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" placeholder="Contoh: Dana sudah diterima di rekening Bank ABC." required></textarea>
                </div>
                <div class="flex justify-end space-x-4 pt-6">
                    <button type="button" class="px-4 py-2 rounded-md text-[var(--text-primary)] hover:bg-[var(--bg-hover)]" onclick="closeModal('verificationModal')">Batal</button>
                    <button type="submit" class="px-6 py-2 rounded-md bg-green-600 hover:bg-green-700 text-white font-semibold">Verifikasi Terpilih</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmModal" class="modal fixed inset-0 bg-black bg-opacity-70 z-[60] hidden items-center justify-center opacity-0" onclick="closeModal('confirmModal')">
        <div class="modal-content bg-[var(--bg-secondary)] rounded-lg shadow-xl p-8 w-full max-w-sm transform scale-95" onclick="event.stopPropagation()">
            <div class="text-center">
                <i id="confirm-icon" data-lucide="alert-triangle" class="w-12 h-12 sm:w-16 sm:h-16 mx-auto text-yellow-400"></i>
                <h3 id="confirm-title" class="text-lg sm:text-xl font-semibold mt-4 mb-2">Konfirmasi Aksi</h3>
                <p id="confirm-message" class="text-[var(--text-secondary)] mb-6">Apakah Anda yakin ingin melanjutkan?</p>
            </div>
            <div class="flex justify-center space-x-4">
                <button id="confirm-cancel-btn" class="px-6 py-2 rounded-md text-[var(--text-primary)] bg-[var(--bg-tertiary)] hover:bg-[var(--border-color)] font-semibold" onclick="closeModal('confirmModal')">Batal</button>
                <button id="confirm-ok-btn" class="px-6 py-2 rounded-md bg-red-600 hover:bg-red-700 text-white font-semibold">Ya, Lanjutkan</button>
            </div>
        </div>
    </div>

    <!-- Price History Modal -->
    <div id="priceHistoryModal" class="modal fixed inset-0 bg-black bg-opacity-70 z-[60] hidden items-center justify-center opacity-0" onclick="closeModal('priceHistoryModal')">
        <div class="modal-content bg-[var(--bg-secondary)] rounded-lg shadow-xl p-8 w-full max-w-2xl transform scale-95" onclick="event.stopPropagation()">
            <h3 id="priceHistoryModalTitle" class="text-lg sm:text-xl font-semibold mb-6">Riwayat Perubahan Harga</h3>
            <div id="priceHistoryContent" class="space-y-4 max-h-[60vh] overflow-y-auto pr-4">
                <!-- History items will be rendered here -->
            </div>
            <div class="flex justify-end pt-6 mt-4 border-t border-[var(--border-color)]">
                <button type="button" class="px-6 py-2 rounded-md text-[var(--text-primary)] bg-[var(--bg-tertiary)] hover:bg-[var(--border-color)] font-semibold" onclick="closeModal('priceHistoryModal')">Tutup</button>
            </div>
        </div>
    </div>

    <!-- Cancellation Modal -->
    <div id="cancellationModal" class="modal fixed inset-0 bg-black bg-opacity-70 z-[60] hidden items-center justify-center opacity-0" onclick="closeModal('cancellationModal')">
        <div class="modal-content bg-[var(--bg-secondary)] rounded-lg shadow-xl p-8 w-full max-w-lg transform scale-95" onclick="event.stopPropagation()">
            <h3 class="text-lg sm:text-xl font-semibold mb-2">Batalkan Booking</h3>
            <p class="text-sm text-[var(--text-secondary)] mb-6">Untuk Booking ID: <span id="cancel-booking-id" class="font-bold"></span></p>
            <form id="formCancellation" class="space-y-4">
                <input type="hidden" id="cancel-booking-id-input">
                <div>
                    <label for="cancellation-reason" class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Alasan Pembatalan</label>
                    <textarea id="cancellation-reason" rows="4" class="w-full bg-[var(--bg-tertiary)] border-[var(--border-color)] rounded-md p-2" placeholder="Contoh: Pelanggan membatalkan karena perubahan jadwal." required></textarea>
                </div>
                <div class="flex justify-end space-x-4 pt-6">
                    <button type="button" class="px-4 py-2 rounded-md text-[var(--text-primary)] hover:bg-[var(--bg-hover)]" onclick="closeModal('cancellationModal')">Tutup</button>
                    <button type="submit" class="px-6 py-2 rounded-md bg-red-600 hover:bg-red-700 text-white font-semibold">Konfirmasi Pembatalan</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Payment History Modal -->
    <div id="paymentHistoryModal" class="modal fixed inset-0 bg-black bg-opacity-70 z-[60] hidden items-center justify-center opacity-0" onclick="closeModal('paymentHistoryModal')">
        <div class="modal-content bg-[var(--bg-secondary)] rounded-lg shadow-xl p-8 w-full max-w-2xl transform scale-95" onclick="event.stopPropagation()">
            <h3 id="paymentHistoryModalTitle" class="text-lg sm:text-xl font-semibold mb-6">Riwayat Pembayaran</h3>
            <div id="paymentHistoryContent" class="space-y-4 max-h-[60vh] overflow-y-auto pr-4">
                <!-- Payment history items will be rendered here -->
            </div>
            <div class="flex justify-end pt-6 mt-4 border-t border-[var(--border-color)]">
                <button type="button" class="px-6 py-2 rounded-md text-[var(--text-primary)] bg-[var(--bg-tertiary)] hover:bg-[var(--border-color)] font-semibold" onclick="closeModal('paymentHistoryModal')">Tutup</button>
            </div>
        </div>
    </div>

    <!-- Proof Modal -->
    <div id="proofModal" class="modal fixed inset-0 bg-black bg-opacity-70 z-[70] hidden items-center justify-center opacity-0" onclick="closeModal('proofModal')">
        <div class="modal-content bg-[var(--bg-secondary)] rounded-lg shadow-xl p-6 w-full max-w-xl transform scale-95" onclick="event.stopPropagation()">
            <h3 class="text-lg font-semibold mb-4">Bukti Pembayaran</h3>
            <div class="bg-[var(--bg-primary)] p-2 rounded-md">
                <img id="proofModalImage" src="" alt="Bukti Pembayaran" class="rounded-md max-w-full h-auto mx-auto max-h-[70vh]">
            </div>
            <div class="flex justify-end pt-6">
                <button type="button" class="px-4 py-2 rounded-md text-[var(--text-primary)] hover:bg-[var(--bg-hover)]" onclick="closeModal('proofModal')">Tutup</button>
            </div>
        </div>
    </div>

    <!-- Link to your new external script file -->
    <script src="app.js" defer></script>
</body>
</html>